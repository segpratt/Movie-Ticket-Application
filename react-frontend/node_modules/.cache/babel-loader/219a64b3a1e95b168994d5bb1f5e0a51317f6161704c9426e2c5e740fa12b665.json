{"ast":null,"code":"import _slicedToArray from\"/Users/justin/Desktop/MEng Repos/ENSF 614/movie-ticket-system/react-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useAppContext}from\"../lib/contextLib\";import{useNavigate}from\"react-router-dom\";import{Link}from'react-router-dom';import Button from'@mui/material/Button';import\"./Login.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var userInfo=undefined;export default function Login(){var nav=useNavigate();// React States\nvar _useState=useState({}),_useState2=_slicedToArray(_useState,2),errorMessages=_useState2[0],setErrorMessages=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isSubmitted=_useState4[0],setIsSubmitted=_useState4[1];var _useAppContext=useAppContext(),userHasAuthenticated=_useAppContext.userHasAuthenticated;var _useAppContext2=useAppContext(),adminAuth=_useAppContext2.adminAuth;var _useAppContext3=useAppContext(),notPaid=_useAppContext3.notPaid;var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),userDB=_useState6[0],setUserDB=_useState6[1];var errors={uname:\"invalid email address\",pass:\"invalid password\"};useEffect(function(){// get registered users\nfetch(\"http://localhost:8080/api/v1/registereduser/all\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\"}}).then(function(response){return response.json();}).then(function(data){setUserDB(data);}).catch(function(){console.log(\"Error\");});},[]);var handleSubmit=function handleSubmit(event){//Prevent page reload\nevent.preventDefault();var _document$forms$=document.forms[0],uname=_document$forms$.uname,pass=_document$forms$.pass;// Find user login info\nvar userData=userDB===null||userDB===void 0?void 0:userDB.find(function(user){return user.email===uname.value;});// Compare user info\nif(userData){if(userData.password!==pass.value){// Invalid password\nsetErrorMessages({name:\"pass\",message:errors.pass});console.log(\"Error. Invalid Password.\");}else{userInfo=userData;setIsSubmitted(true);userHasAuthenticated(true);adminAuth(false);var d1=Date.parse(userData.dateRegistered);var d2=Date.parse(\"2022-12-01\");console.log(d1);console.log(d2);if(d1>d2){nav(\"/movie-ticket-system/theatres\");}else{notPaid(true);nav(\"/movie-ticket-system/annualfee\");}}}else{// Email not found\nsetErrorMessages({name:\"uname\",message:errors.uname});console.log(\"Error. Invalid Email.\");}};var guestHandle=function guestHandle(event){event.preventDefault();var uname=\"guest\";var pass=\"guest\";userInfo=userDB[2];setIsSubmitted(true);userHasAuthenticated(true);adminAuth(false);nav(\"/movie-ticket-system/theatres\");};// Generate JSX code for error message\nvar renderErrorMessage=function renderErrorMessage(name){return name===errorMessages.name&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:errorMessages.message});};// JSX code for login form\nvar renderForm=/*#__PURE__*/_jsx(\"div\",{className:\"form\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-container\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email Address \"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"uname\",required:true}),renderErrorMessage(\"uname\")]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-container\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Password \"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"pass\",required:true}),renderErrorMessage(\"pass\")]}),/*#__PURE__*/_jsx(\"div\",{className:\"input-container\",children:/*#__PURE__*/_jsx(Link,{onClick:guestHandle,children:\"Continue as Guest\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"button-container\",children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleSubmit,children:\"Submit\"})})]})});return/*#__PURE__*/_jsx(\"div\",{className:\"app\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-form\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title\",children:\"Login\"}),isSubmitted?/*#__PURE__*/_jsx(\"div\",{children:\"User is successfully logged in\"}):renderForm]})});}","map":{"version":3,"names":["React","useState","useEffect","useAppContext","useNavigate","Link","Button","userInfo","undefined","Login","nav","errorMessages","setErrorMessages","isSubmitted","setIsSubmitted","userHasAuthenticated","adminAuth","notPaid","userDB","setUserDB","errors","uname","pass","fetch","method","headers","then","response","json","data","catch","console","log","handleSubmit","event","preventDefault","document","forms","userData","find","user","email","value","password","name","message","d1","Date","parse","dateRegistered","d2","guestHandle","renderErrorMessage","renderForm"],"sources":["/Users/justin/Desktop/MEng Repos/ENSF 614/movie-ticket-system/react-frontend/src/containers/Login.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useAppContext } from \"../lib/contextLib\";\nimport { useNavigate } from \"react-router-dom\";\nimport { Link } from 'react-router-dom';\nimport Button from '@mui/material/Button';\nimport \"./Login.css\";\nexport var userInfo = undefined;\n\nexport default function Login() {\n  const nav = useNavigate();\n\n  // React States\n  const [errorMessages, setErrorMessages] = useState({});\n  const [isSubmitted, setIsSubmitted] = useState(false);\n  const { userHasAuthenticated } = useAppContext();\n  const { adminAuth } = useAppContext();\n  const { notPaid } = useAppContext();\n\n  const [userDB, setUserDB] = useState();\n\n  const errors = {\n    uname: \"invalid email address\",\n    pass: \"invalid password\"\n  };\n\n  useEffect(() => {\n\t\t// get registered users\n    fetch(\"http://localhost:8080/api/v1/registereduser/all\", {\n\t\t\tmethod: \"GET\",\n\t\t\theaders: { \"Content-Type\": \"application/json\" },\n      })\n        .then((response) => {\n          return response.json();\n        })\n        .then((data) => {\n          setUserDB(data);\n        })\n        .catch(() => {\n          console.log(\"Error\");\n        });\n\t}, []);\n\n  const handleSubmit = (event) => {\n      //Prevent page reload\n      event.preventDefault();\n\n      var { uname, pass } = document.forms[0];\n\n      // Find user login info\n      const userData = userDB?.find((user) => user.email === uname.value);\n\n      // Compare user info\n      if (userData) {\n        if (userData.password !== pass.value) {\n          // Invalid password\n          setErrorMessages({ name: \"pass\", message: errors.pass });\n          console.log(\"Error. Invalid Password.\");\n        } else {\n          userInfo = userData;\n          setIsSubmitted(true);\n          userHasAuthenticated(true)\n          adminAuth(false)\n          var d1 = Date.parse(userData.dateRegistered)\n          var d2 = Date.parse(\"2022-12-01\")\n          console.log(d1)\n          console.log(d2)\n          if (d1 > d2) {\n            nav(\"/movie-ticket-system/theatres\");\n          } else {\n            notPaid(true);\n            nav(\"/movie-ticket-system/annualfee\");\n          }\n        }\n      } else {\n        // Email not found\n        setErrorMessages({ name: \"uname\", message: errors.uname });\n        console.log(\"Error. Invalid Email.\");\n      }\n  };\n\n  const guestHandle = (event) => {\n    event.preventDefault();\n    const uname = \"guest\";\n    const pass = \"guest\";\n    userInfo = userDB[2];\n    setIsSubmitted(true);\n    userHasAuthenticated(true)\n    adminAuth(false)\n    nav(\"/movie-ticket-system/theatres\");\n};\n\n  // Generate JSX code for error message\n  const renderErrorMessage = (name) =>\n    name === errorMessages.name && (\n      <div className=\"error\">{errorMessages.message}</div>\n  );\n\n  // JSX code for login form\n  const renderForm = (\n    <div className=\"form\">\n      <form onSubmit={handleSubmit}>\n        <div className=\"input-container\">\n          <label>Email Address </label>\n          <input type=\"text\" name=\"uname\" required />\n          {renderErrorMessage(\"uname\")}\n        </div>\n        <div className=\"input-container\">\n          <label>Password </label>\n          <input type=\"password\" name=\"pass\" required />\n          {renderErrorMessage(\"pass\")}\n        </div>\n        <div className=\"input-container\">\n          <Link onClick={guestHandle}>\n            Continue as Guest\n          </Link>\n        </div>\n        <div className=\"button-container\">\n          <Button variant=\"contained\" onClick={handleSubmit}>\n            Submit\n          </Button>\n        </div>\n      </form>\n    </div>\n  );\n\n  return (\n    <div className=\"app\">\n      <div className=\"login-form\">\n        <div className=\"title\">Login</div>\n        {isSubmitted ? <div>User is successfully logged in</div> : renderForm}\n      </div>\n    </div>\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}